<!DOCTYPE html>
<html>

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width   , initial-scale=1">

    <!-- Bootstrap CSS and styling -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/6.0.0/firebase-ui-auth.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link type="text/css" rel="stylesheet" href="../styles/userprofile_style.css" />
    <link type="text/css" rel="stylesheet" href="../styles/color_theme.css" />

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous">
    </script>

    <!-- Firebase 8 CDNs-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous">
    </script>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/ui/6.0.0/firebase-ui-auth.js"></script>

    <!-- Link to external scripts -->
    <script src="/scripts/firebaseAPI.js"></script>
    <script src="/scripts/userprofile_script.js" async></script>

    <title>Communiti User Profile</title>

</head>

<body class="bg-generic">

    <!-------------------------------------->
    <!-- The following is HTML for layout -->
    <!-------------------------------------->
    <!-- Header Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-header m-3">
        <div class="container-fluid d-flex">
            <div>
                <a class="btn bg-header position-relative start-0" data-bs-toggle="collapse" href="#collapseLinks"
                    role="button" aria-expanded="false" aria-controls="collapseExample">
                    <i class="material-icons">menu</i>
                </a>
            </div>

            <a class="navbar-brand" style="margin-left:11%;" href="../main.html">Communiti</a>
            <a class="nav-link disabled nav-bar-right" href="edit_profile.html" aria-disabled="true">
                <span id="name">Name</span> <i class="material-icons">person_outline</i>
            </a>
        </div>
    </nav>

    <div class="collapse" id="collapseLinks">
        <div class="card card-body" style="margin-left:20px;width:80%;">
            <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                <li class="nav-item active">
                    <a class="nav-link" href="../main.html">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../html/request/1_location.html">Make a new request</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../html/active.html">View your active/saved requests</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" onclick="logout()">Sign out</a>
                </li>
            </ul>
        </div>
    </div>

    <!-- Content -->
    <div id="content" class="container bg-greygreen">
        <div class="header-bg bg-window">
            <h1 class="headerstyle"><span id="name2"></span>'s Profile</h1>
        </div>
        <div id="inner-content">
            <div class="largerfont" id="studentdiv">Student Number:<br>A<span id="stuNum"></span></div>
            <div class="largerfont" id="publicdiv">Phone number:</div><span id="phoneNum"></span> <br>
            <p id="vaxxeddiv" class="greentext">You are vaccinated.</p>
            <b id="notvax" class="redtext">You are not vaccinated.</b>
            <br>

            <form>
                <fieldset class="mb-3" id="personalInfoFields" disabled>
                    <div class="form-group">
                        <label class="largerfont">Name</label>
                        <input type="text" id="nameInput" class="form-control" placeholder="Enter your name">
                    </div>
                    <br>
                    <div class="form-group">
                        <label class="largerfont">About you:</label>
                        <textarea type="text" id="userAbout" class="form-control" rows="5"
                            placeholder="Enter a description about you"></textarea>
                    </div>
                </fieldset>
                <br>
                <div class="d-flex justify-content-end">
                    <button type="button" class="btn bg-window" onclick="editUserInfo()">Edit</button>
                    <span style="width: 10px"></span>
                    <button type="button" class="btn bg-submit" onclick="saveUserInfo()">Save</button>
                </div>
                <br><br>
            </form>
        </div>

    </div>

    <script>
        function insertName2() {
            firebase.auth().onAuthStateChanged(user => {
                // Check if user is signed in:
                if (user) {
                    // Do something for the current logged-in user here: 
                    //console.log(user.uid);
                    //go to the correct user document by referencing to the user uid
                    currentUser = db.collection("users").doc(user.uid);
                    //get the document for current user.
                    currentUser.get()
                        .then(userDoc => {
                            var user_Name = userDoc.data().name;
                            //console.log(user_Name);
                            //method #1:  insert with html only
                            //document.getElementById("name-goes-here").innerText = n;    //using javascript
                            //method #2:  insert using jquery
                            $("#name2").text(user_Name); //using jquery
                        })
                } else {
                    // No user is signed in.
                }
            });
        }

        insertName2();
    </script>
</body>

</html>